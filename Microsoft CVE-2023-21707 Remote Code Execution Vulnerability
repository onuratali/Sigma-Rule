title: Microsoft Exchange Powershell Remoting Deserialization leading to RCE (CVE-2023-21707)
id: 3e4f4e8c-66e3-4df6-9d26-cb1d463f8520
status: stable
description: This rule detects an attempt to exploit Microsoft CVE-2023-21707 Remote Code Execution Vulnerability in Microsoft Exchange Server.
references:
- https://starlabs.sg/blog/2023/04-microsoft-exchange-powershell-remoting-deserialization-leading-to-rce-cve-2023-21707/
author: Onur Atali
tags:
- attack.initial_access
- attack.t1190
- attack.execution
- attack.t1059.003
logsource:
  product: windows
  category: ps_script
  definition: "Requirements: Script Block Logging must be enabled"
detection:
  selection:
    ScriptBlockText|contains|all:
    - PSCredential
    - remoteCredential
    - WSManConnectionInfo
    - wsmanConnectionInfo.AuthenticationMechanism
    - wsmanConnectionInfo.MaximumConnectionRedirectionCount
    - wsmanConnectionInfo.SkipCACheck
  condition: selection
falsepositives:
- Unknown
level: medium